{%- liquid
  assign page_handle = page.handle
  assign enable_breadcrumb = settings.enable_breadcrumb
  assign listObject = settings.page_breadcrumb | split: ','
  
  if listObject contains page_handle
    assign showBreadcrumb = false
  else
    assign showBreadcrumb = true
  endif

  # Define which templates should be excluded
  assign excluded_templates = 'index,cart'
  if settings.enable_post == false
    assign excluded_templates = excluded_templates | append: ',blog'
  endif
  if settings.enable_article == false
    assign excluded_templates = excluded_templates | append: ',article'
  endif
  if settings.enable_product == false
    assign excluded_templates = excluded_templates | append: ',product'
  endif
  if settings.enable_customer == false
    assign excluded_templates = excluded_templates | append: ',customers'
  endif
  
  assign excluded_array = excluded_templates | split: ','
  assign show_on_template = true
  
  for excluded in excluded_array
    if template contains excluded
      assign show_on_template = false
      break
    endif
  endfor
-%}

{%- if enable_breadcrumb and showBreadcrumb and show_on_template -%}
<style>
  .g-breadcrumb{
    border-radius: 0;
    flex-direction: column;
    color: {{ settings.color_breadcrumbs }};
    padding: 16px 0;
    margin: 0;
    background: {{ settings.bg_breadcrumb }};
    border-top: 1px solid {{ settings.border_breadcrumb }};
  }
  .g-breadcrumb a, .g-breadcrumb span { 
    padding: 0 3px; 
    font-size: 14px; 
    line-height: 20px; 
    display: inline-block; 
  }
  .g-breadcrumb a {
    color: {{ settings.color_breadcrumbs_active }};
  }
  .g-breadcrumb .container, .g-breadcrumb .container-fluid { 
    z-index: 2; 
    position: relative; 
  }
  .br-title {
    color: {{ settings.color_breadcrumbs }};
  }
  .br-title svg {
    width: 23px;
    height: 23px;
  }
</style>

<nav class="breadcrumb g-breadcrumb text-{{ settings.align_bread }}" role="navigation" aria-label="breadcrumbs">
  <div class="{{ settings.layout_bread }}">
    <a href="/" title="{{ 'general.breadcrumb.home' | t }}">{{ 'general.breadcrumb.home' | t }}</a>
    
    {% if template contains 'page' %}
      <span aria-hidden="true"> / </span>
      <span>{{ page.title }}</span>
      
    {% elsif template contains 'product' %}
      {% if collection and collection.url %}
        <span aria-hidden="true"> / </span>
        <a href="{{ collection.url }}">{{ collection.title }}</a>
      {% endif %}
      <span aria-hidden="true"> / </span>
      <span>{{ product.title }}</span>
      
    {% elsif template contains 'collection' and collection.handle %}
      <span aria-hidden="true"> / </span>
      {% if current_tags %}
        {% capture collection_url %}/collections/{{ collection.handle }}{% endcapture %}
        <a href="{{ collection_url }}">{{ collection.title }}</a>
        <span aria-hidden="true"> / </span>
        <span>{{ current_tags | join: " + " }}</span>
      {% else %}
        <span>{{ collection.title }}</span>
      {% endif %}
      
    {% elsif template == 'blog' %}
      <span aria-hidden="true"> / </span>
      {% if current_tags %}
        <a href="{{ blog.url }}">{{ blog.title }}</a>
        <span aria-hidden="true"> / </span>
        <span>{{ current_tags | join: " + " }}</span>
      {% else %}
        <span>{{ blog.title }}</span>
      {% endif %}
      
    {% elsif template == 'article' %}
      <span aria-hidden="true"> / </span>
      <a href="{{ blog.url }}">{{ blog.title }}</a>
      <span aria-hidden="true"> / </span>
      <span>{{ article.title }}</span>
      
    {% else %}
      <span aria-hidden="true"> / </span>
      <span>{{ page_title }}</span>
    {% endif %}
  </div>
</nav>
{%- endif -%}
